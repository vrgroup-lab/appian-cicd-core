name: Export (Reusable)


on:
  workflow_call:
    inputs:
      manifest_path:            { required: true, type: string }
      export_scope:             { required: true, type: string }   # "app" | "package"
      package_name:             { required: false, type: string }  # requerido si export_scope=="package"
      appian_url:               { required: true, type: string }   # viene del repo app (variable)
      app_props_public_json:    { required: true, type: string }   # viene del repo app (variable)
    secrets:
      APPIAN_API_KEY: { required: true }

jobs:
  export:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Export from Appian
        uses: ./.github/actions/export
        with:
          base-url: ${{ inputs.base-url }}
          api-key: ${{ secrets.APPIAN_API_KEY }}
          export-type: ${{ inputs.export-type }}
          uuid: ${{ inputs.uuid }}
          name: ${{ inputs.name }}
          description: ${{ inputs.description }}
          poll-timeout-sec: ${{ inputs.poll-timeout-sec }}
          poll-interval-sec: ${{ inputs['poll-interval-sec'] }}
          download-out: ${{ inputs['download-out'] }}

